Olá.
Acho que consegui resolver a questão do java. 
Infelizmente, não consegui a de SQL.

Mas destaco uma observação. Talvez haja um errinho na questão do sql. Pois
se eu subtrair os valores (value) cuja tupla possui o (event_type) = 3 o resultado deveria ser 0, não?
Vide o exemplo que me enviaram.

Obrigado pela oportunidade.